TIMESTAMP ---




-------------

OBJECT PROPERTIES

PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX hr: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/1#>
PREFIX hr2: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/rules1#>

CONSTRUCT {
    ?person hr2:hasDegree ?degree .
    ?person hr2:hasEmeritus ?emeritus .
    ?person hr2:hasJob ?job .
    ?person hr2:hasLeave ?leave .
    ?person hr2:hasSeparation ?separation .
    ?person hr2:hasBillingReserve ?billingReserve .
} WHERE {
   { ?person hr:person_Emplid ?emplid .
     ?degree hr:degree_Emplid ?emplid 
   } UNION 
   { ?person hr:person_Emplid ?emplid .
     ?emeritus hr:emeritus_Emplid ?emplid 
   } UNION 
   { ?person hr:person_Emplid ?emplid .
     ?job hr:job_Emplid ?emplid 
   } UNION 
   { ?person hr:person_Emplid ?emplid .
     ?leave hr:leave_Emplid ?emplid 
   } UNION 
   { ?person hr:person_Emplid ?emplid .
     ?separation hr:separation_Emplid ?emplid 
   } UNION
   { ?person hr:person_Emplid ?emplid .
     ?billingReserve hr:billingreserve_Emplid ?emplid 
   }
}


----- Separations linked to jobs

# CONSTRUCT to link separations to jobs separated

PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX hr1: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/1#>
PREFIX hr2: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/rules1#>

CONSTRUCT {
    ?job hr2:separatedBy ?separation .
    ?separation hr2:separates ?job
} WHERE {
    ?separation hr1:separation_PositionNbr ?positionNbr .
    ?separation hr1:separation_Emplid ?emplid .
    ?job hr1:job_PositionNbr ?positionNbr .
    ?job hr1:job_Emplid ?emplid .
    OPTIONAL {
    	?job hr2:separatedBy ?existingSeparation .
    }
    FILTER(!bound(?existingSeparation))
# FILTER so we don't re-separate jobs that have already been separated!
# makes this non-SWRLizable possibly, unless we can do something with date built-ins
} 


--- Weill flags

PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX vitro: <http://vitro.mannlib.cornell.edu/ns/vitro/0.7#>
PREFIX vivo:  <http://vivo.library.cornell.edu/ns/0.1#>
PREFIX mann:  <http://vivo.cornell.edu/ns/mannadditions/0.1#>
#
# This query gets all range entities labels and types of a person
# A query like this could be used to get enough info to create a display
# page for an entity.
#
CONSTRUCT { ?person rdf:type vitro:Flag2ValueWeillMedicalThing }
WHERE {
    ?person <http://vivo.library.cornell.edu/ns/0.1#employeeOfAsAcademicFacultyMember> ?dept .
    ?dept <http://vivo.library.cornell.edu/ns/0.1#departmentOrDivisionWithin> <http://vivo.library.cornell.edu/ns/0.1#individual192> .
}

--- gonefaculty

PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX vitro: <http://vitro.mannlib.cornell.edu/ns/vitro/0.7#>
PREFIX vivo:  <http://vivo.library.cornell.edu/ns/0.1#>
PREFIX mann:  <http://vivo.cornell.edu/ns/mannadditions/0.1#>
PREFIX afn:   <http://jena.hpl.hp.com/ARQ/function#>
#
# This query gets all range entities labels and types of a person
# A query like this could be used to get enough info to create a display
# page for an entity.
#
SELECT ?person
WHERE 
{
 ?person rdf:type mann:CornellFaculty .
 OPTIONAL {
    ?person rdf:type vitro:Flag2ValueWeillMedicalThing .
    ?person rdfs:label ?label .
 }
 OPTIONAL {
    ?person vitro:sunset ?sunset
 }
 OPTIONAL {
    ?person <http://vivo.cornell.edu/ns/hr/0.9/hr.owl#emplId> ?emplid
 }
 FILTER (!bound(?label))
 FILTER ( (!bound(?sunset)) || (?sunset > afn:now()) )
 FILTER (!bound(?emplid))
}


---- emeritus assertions (requires outputPlainNetids to be attached)
PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX vitro: <http://vitro.mannlib.cornell.edu/ns/vitro/0.7#>
PREFIX vivo:  <http://vivo.library.cornell.edu/ns/0.1#>
PREFIX vivot: <temp://vivo.library.cornell.edu/ns/0.1#>
PREFIX mann:  <http://vivo.cornell.edu/ns/mannadditions/0.1#>
PREFIX hr1: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/1#>
PREFIX hr2: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/rules1#>

#
# This query gets all range entities labels and types of a person
# A query like this could be used to get enough info to create a display
# page for an entity.
#
CONSTRUCT {
    ?person rdf:type <http://vivo.cornell.edu/ns/hr/0.9/hr.owl#CornellEmeritusProfessor> .
    ?person vitro:moniker "Professor Emeritus/a"@en-US .
    ?person <http://vivo.cornell.edu/ns/hr/0.9/hr.owl#emeritusProfessorIn> ?dept .
    ?dept <http://vivo.cornell.edu/ns/hr/0.9/hr.owl#hasEmeritusProfessor> ?person
} WHERE {
    ?emeritusData hr1:emeritus_Netid ?netid .
    ?person vivot:CornellemailnetId ?netid 
    OPTIONAL {
        ?person vivo:employeeOfAsAcademicFacultyMember ?dept .
        ?dept vivo:hasEmployeeAcademicFacultyMember ?person 
    }
}

-----
emeritus assertions (run query after emeritus assertions, but execute retraction first)
-----
PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>
PREFIX vitro: <http://vitro.mannlib.cornell.edu/ns/vitro/0.7#>
PREFIX vivo:  <http://vivo.library.cornell.edu/ns/0.1#>
PREFIX vivot: <temp://vivo.library.cornell.edu/ns/0.1#>
PREFIX mann:  <http://vivo.cornell.edu/ns/mannadditions/0.1#>
PREFIX hr1: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/1#>
PREFIX hr2: <http://vitro.mannlib.cornell.edu/ns/bjl23/hr/rules1#>

#
# This query gets all range entities labels and types of a person
# A query like this could be used to get enough info to create a display
# page for an entity.
#
CONSTRUCT {
    ?person rdf:type ?type .
    ?person vitro:moniker ?moniker .
    ?person vivo:employeeOfAsAcademicFacultyMember ?dept .
    ?dept vivo:hasEmployeeAcademicFacultyMember ?person 
} WHERE {
    ?emeritusData hr1:emeritus_Netid ?netid .
    ?person vivot:CornellemailnetId ?netid 
    OPTIONAL {
        ?person vivo:employeeOfAsAcademicFacultyMember ?dept .
        ?dept vivo:hasEmployeeAcademicFacultyMember ?person 
    }
    ?person rdf:type ?type 
    FILTER (!regex(str(?type),"0.7#Flag"))
    ?person vitro:moniker ?moniker
}




    
    