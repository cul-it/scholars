@prefix : <http://vitro.mannlib.cornell.edu/ns/vitro/ApplicationSetup#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

#
# configure the DistributeDataApiController.
#

:data_distributor_person_word_cloud :actionName "person_word_cloud" .
:data_distributor_person_word_cloud
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.PersonWordCloudDistributor> .

:data_distributor_organization_research_areas :actionName "organization_research_areas" .
:data_distributor_organization_research_areas
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.FileDistributor> ;
    :path "fakeData/fake_organization_research_areas.ttl" ;
    :contentType "text/turtle" .

:data_distributor_collaborations :actionName "collaboration_sunburst" .
:data_distributor_collaborations
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.FileDistributor> ;
    :path "fakeData/fake_collab_data.json" ;
    :contentType "application/json" .

:data_distributor_ra_bubble_chart :actionName "research_area_bubbles" .
:data_distributor_ra_bubble_chart
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.FileDistributor> ;
    :path "fakeData/fake_bubble_chart_data.json" ;
    :contentType "application/json" .

# ---- GRANTS BUBBLE CHART ----

#:data_distributor_grants_page :actionName "grants_bubble_chart" .
:data_distributor_grants_page
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.GrantsBubbleChartDistributor> .

#:data_distributor_grants_page_live :actionName "grants_bubble_chart" .
:data_distributor_grants_page_live
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.SparqlSelectDataDistributor> ;
    :query """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
      
      SELECT ?grant ?grantTitle ?grantType
             ?amount ?fundingOrg ?fundingOrgName
             ?person ?personName ?personNetid
             ?dept ?deptName
             ?startYear ?endYear
      
      WHERE
      {
        {
          {
            ?grant a vivo:Grant .
            BIND("GRANT" AS ?grantType) .
          } UNION {
            ?grant a vivo:Contract .
            BIND("CONTRACT" AS ?grantType) .
          } UNION {
            ?grant a vivo:CooperativeAgreement .
            BIND("COOPERATIVE_AGREEMENT" AS ?grantType) .
          }
        }
        ?grant rdfs:label ?grantTitle .
       
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?grant vivo:relates ?node1 .
        ?node1 a vivo:PrincipalInvestigatorRole .
        ?node1 obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        BIND(SUBSTR(STR(?enddt),1,4) AS ?endYear) .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
        BIND(SUBSTR(STR(?startdt),1,4) AS ?startYear) .
      }
      """ .

#:data_distributor_grants_page_with_optionals :actionName "grants_bubble_chart" .
:data_distributor_grants_page_with_optionals
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.SparqlSelectDataDistributor> ;
    :query """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
      
      SELECT ?grant ?grantTitle ?grantType
             ?amount ?fundingOrg ?fundingOrgName
             ?person ?personName ?personNetid
             ?dept ?deptName
             ?startYear ?endYear
      
      WHERE
      {
        {
          {
            ?grant a vivo:Grant .
            BIND("GRANT" AS ?grantType) .
          } UNION {
            ?grant a vivo:Contract .
            BIND("CONTRACT" AS ?grantType) .
          } UNION {
            ?grant a vivo:CooperativeAgreement .
            BIND("COOPERATIVE_AGREEMENT" AS ?grantType) .
          }
        }
        ?grant rdfs:label ?grantTitle .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        BIND(SUBSTR(STR(?enddt),1,4) AS ?endYear) .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
        BIND(SUBSTR(STR(?startdt),1,4) AS ?startYear) .
       
        OPTIONAL {
          ?grant vivo:relates ?node1 .
          ?node1 a vivo:PrincipalInvestigatorRole .
          ?node1 obo:RO_0000052 ?person .
          ?person rdfs:label ?personName .
          ?person scholars-hr:netId ?personNetid .
        }
       
        OPTIONAL {
          ?grant vivo:relates ?node2 .
          ?node2 a vivo:AdministratorRole .
          ?node2 obo:RO_0000052 ?dept .
          ?dept rdfs:label ?deptName .
        }
       
        OPTIONAL {
          ?grant vivo:totalAwardAmount ?amount .
          ?grant vivo:assignedBy ?fundingOrg .
          ?fundingOrg rdfs:label ?fundingOrgName .
        }
      }
      """ .

#:data_distributor_grants_page_with_sub :actionName "grants_bubble_chart" .
:data_distributor_grants_page_with_sub
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.SparqlSelectDataDistributor> ;
    :query """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
      
      SELECT ?grant ?grantTitle ?grantType
             ?amount ?fundingOrg ?fundingOrgName
             ?person ?personName ?personNetid
             ?dept ?deptName
             ?startYear ?endYear
      
      WHERE {
        {
          SELECT ?grant ?grantType
          WHERE {
            {
              ?grant a vivo:Grant .
              BIND("GRANT" AS ?grantType) .
              ?grant vivo:relates ?roleNode .
              ?roleNode a vivo:PrincipalInvestigatorRole .
              BIND("PI" AS ?role) .
            } UNION {
              ?grant a vivo:Contract .
              BIND("CONTRACT" AS ?grantType) .
              ?grant vivo:relates ?roleNode .
              ?roleNode a vivo:PrincipalInvestigatorRole .
              BIND("PI" AS ?role) .
            } UNION {
              ?grant a vivo:CooperativeAgreement .
              BIND("COOPERATIVE_AGREEMENT" AS ?grantType) .
              ?grant vivo:relates ?roleNode .
              ?roleNode a vivo:PrincipalInvestigatorRole .
              BIND("PI" AS ?role) .
            } UNION {
              ?grant a vivo:Grant .
              BIND("GRANT" AS ?grantType) .
              ?grant vivo:relates ?roleNode .
              ?roleNode a vivo:CoPrincipalInvestigatorRole .
              BIND("CO" AS ?role) .
            } UNION {
              ?grant a vivo:Contract .
              BIND("CONTRACT" AS ?grantType) .
              ?grant vivo:relates ?roleNode .
              ?roleNode a vivo:CoPrincipalInvestigatorRole .
              BIND("CO" AS ?role) .
            } UNION {
              ?grant a vivo:CooperativeAgreement .
              BIND("COOPERATIVE_AGREEMENT" AS ?grantType) .
              ?grant vivo:relates ?roleNode .
              ?roleNode a vivo:CoPrincipalInvestigatorRole .
              BIND("CO" AS ?role) .
            }
          }
        }
        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        BIND(SUBSTR(STR(?enddt),1,4) AS ?endYear) .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
        BIND(SUBSTR(STR(?startdt),1,4) AS ?startYear) .
      }
      """ .
#
# Grants data:
#
# Six construct queries and a select query. The six construct queries handle
# the combinations of Grant/Contract/CooperativeInvestigation and 
# PrincipalInvestigator/CoPrincipalInvestigator. The six separate queries run
# much more quickly than a single query build using UNIONs or FILTERs.
#
# Javed says this about the data:
# - Every grant should have a link to at least one person. Person can have PI 
#     or Co-PI Role.
# - A grant may or may not have a funding agency linked to it. 
#     (thus this info should be OPTIONAL)
# - A grant may or may not have a administering organization linked to it. 
#     (thus, this should be OPTIONAL)
# - An award amount can be either a positive integer or 0. But I believe, it 
#     should be there. Perhaps, we should remove the triples that mention award
#     amount as “0.0” . But, may be later.
# - Time interval, I believe it should be there for every grant.
#
:data_distributor_grants_page_construct_select :actionName "grants_bubble_chart" .
:data_distributor_grants_page_construct_select
    a   <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.DataDistributor> ,
        <java:edu.cornell.mannlib.vitro.webapp.controller.api.distribute.SparqlConstructSelectDataDistributor> ;
    :constructQuery """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
 
      CONSTRUCT {     
        ?grant a vivo:Grant .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:PrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      } 
      WHERE {
        ?grant a vivo:Grant .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:PrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      }
      """ ;
    :constructQuery """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
 
      CONSTRUCT {     
        ?grant a vivo:Grant .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:CoPrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      } 
      WHERE {
        ?grant a vivo:Grant .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:CoPrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      }
      """ ;
    :constructQuery """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
 
      CONSTRUCT {     
        ?grant a vivo:Contract .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:PrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      } 
      WHERE {
        ?grant a vivo:Contract .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:PrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      }
      """ ;
    :constructQuery """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
 
      CONSTRUCT {     
        ?grant a vivo:Contract .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:CoPrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      } 
      WHERE {
        ?grant a vivo:Contract .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:CoPrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      }
      """ ;
    :constructQuery """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
 
      CONSTRUCT {     
        ?grant a vivo:CooperativeAgreement .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:PrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      } 
      WHERE {
        ?grant a vivo:CooperativeAgreement .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:PrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      }
      """ ;
    :constructQuery """
      PREFIX local:          <http://scholars.cornell.edu/individual/>
      PREFIX obo:            <http://purl.obolibrary.org/obo/>
      PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
      PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
      PREFIX vivo:           <http://vivoweb.org/ontology/core#>
 
      CONSTRUCT {     
        ?grant a vivo:CooperativeAgreement .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:CoPrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      } 
      WHERE {
        ?grant a vivo:CooperativeAgreement .
        ?grant vivo:relates ?roleNode .
        ?roleNode a vivo:CoPrincipalInvestigatorRole .

        ?grant rdfs:label ?grantTitle .
        ?grant vivo:totalAwardAmount ?amount .
        ?grant vivo:assignedBy ?fundingOrg .
        ?fundingOrg rdfs:label ?fundingOrgName .
       
        ?roleNode obo:RO_0000052 ?person .
        ?person rdfs:label ?personName .
        ?person scholars-hr:netId ?personNetid .
       
        ?grant vivo:relates ?node2 .
        ?node2 a vivo:AdministratorRole .
        ?node2 obo:RO_0000052 ?dept .
        ?dept rdfs:label ?deptName .
       
        ?grant vivo:dateTimeInterval ?dti .
        ?dti vivo:end ?end .
        ?end vivo:dateTime ?enddt .
        ?dti vivo:start ?start .
        ?start vivo:dateTime ?startdt .
      }
      """ ;
    :selectQuery """
        PREFIX local:          <http://scholars.cornell.edu/individual/>
        PREFIX obo:            <http://purl.obolibrary.org/obo/>
        PREFIX rdfs:           <http://www.w3.org/2000/01/rdf-schema#>
        PREFIX scholars-grant: <http://scholars.cornell.edu/ontology/grant.owl#>
        PREFIX scholars-hr:    <http://scholars.cornell.edu/ontology/hr.owl#>
        PREFIX vivo:           <http://vivoweb.org/ontology/core#>
      
        SELECT ?grant ?grantTitle ?type
               ?amount ?fundingOrg ?fundingOrgName
               ?person ?personName ?personNetid ?role
               ?dept ?deptName
               ?startdt ?enddt
      
        WHERE
        {
          ?grant a ?type .
          ?grant rdfs:label ?grantTitle .
       
          ?grant vivo:totalAwardAmount ?amount .
          ?grant vivo:assignedBy ?fundingOrg .
          ?fundingOrg rdfs:label ?fundingOrgName .
       
          ?grant vivo:relates ?node1 .
          ?node1 a ?role .
          ?node1 obo:RO_0000052 ?person .
          ?person rdfs:label ?personName .
          ?person scholars-hr:netId ?personNetid .
       
          ?grant vivo:relates ?node2 .
          ?node2 a vivo:AdministratorRole .
          ?node2 obo:RO_0000052 ?dept .
          ?dept rdfs:label ?deptName .
       
          ?grant vivo:dateTimeInterval ?dti .
          ?dti vivo:end ?end .
          ?end vivo:dateTime ?enddt .
          ?dti vivo:start ?start .
          ?start vivo:dateTime ?startdt .
        }
        """ .
      